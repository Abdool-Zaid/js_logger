<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="a simple time logger for capturing the elapse time spent working in a day made by aspiring developer Abdool Zaid Toorabally email: aztoorabally7447@gmail.com">
    <title>time logger</title>
    <style>.rem{
                display: none;
                }
    </style>
</head>
<body>
    <button id="init">start</button>
    <button id="pause">pause</button>
    <button id="res">get logs</button>
</body>
<script>
    let init={}
        init.val=window.localStorage.init? JSON.parse(window.localStorage.init) : false
        init.corpus= document.querySelector("#init")
        init.text=['stop','start']
        init.func= (self)=>{
           time.push([self.corpus.innerHTML,self.time])
                  pause.corpus.classList.toggle('rem')
        }
        let pause ={}
        pause.val = window.localStorage.pause? JSON.parse(window.localStorage.pause) : false
        pause.corpus= document.querySelector("#pause")
        pause.text= ['resume', 'pause']
        pause.func=(self)=>{
            time.push([self.corpus.innerHTML,self.time])
            localStorage.setItem("time", JSON.stringify(time))
        }
        let res = {}
        res.val= window.localStorage.res? JSON.parse(window.localStorage.res) : false
        res.corpus= document.querySelector('#res')
        res.text=[ 'get logs', 'get logs']
        res.func=(self)=>{
                let rep ='report \n'               
                            time.forEach((log)=>{
                                const date = new Date(log[1]);
                                const formattedDate = date.toLocaleString();
                                console.log(`${log[0]} : ${formattedDate} \n`)
                                rep += `${log[0]} : ${formattedDate} \n`

                            })
                            console.log(rep)
                      
                            navigator.clipboard
                              .writeText(rep)
                              .then(() => alert('logs copied to clipboard'))
                              .catch((err) => console.log(err))
                            
                        }
        let time = localStorage.time? JSON.parse(localStorage.time): []
        let report
        btn = document.querySelectorAll('button')
        btn.forEach(element => {
            let val 
            try {
                
                eval(`val = JSON.parse(window.localStorage.${element.id})`)
                console.log(element.innerHTML)
                if(element.innerHTML=="start"){
                    pause.corpus.classList.toggle('rem')
                }
            } catch (error) {
                console.error(error)
            }
            if (val){
                if (val == true){
                    let obj
                                eval(`obj= ${element.id}`)
                                element.innerHTML=obj.text[0]
                            }        
                        }
                    });
                    
                    window.addEventListener('click',(e)=>{
                        if(e.target.id != false){
                            let obj 
                            eval(`obj= ${e.target.id}`)
                            obj.time= Date.now()
                            
                            obj.func(obj)
                            if (obj.val==false){
                                obj.corpus.innerHTML= obj.text[0]
                            }else{
                                obj.corpus.innerHTML= obj.text[1]
                            }
                            obj.val= !obj.val
                            window.localStorage.setItem(e.target.id,JSON.stringify(obj.val))
                            
                        }else{
                        }
                    })



//     fin.addEventListener('click',()=>{
//        
//     })

</script>
</html>